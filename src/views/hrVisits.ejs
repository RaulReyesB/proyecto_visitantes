<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/styleRecurVi.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>

<body>
    <div class="fondo"></div>

    <nav id="var" class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <img src="/img/rtyh_logo.webp" alt="Logo">
            </a>
            
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <br>
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/registroInternos">Pasantes</a>
                    </li>
                    <% if (user && user.type !=='rh' ) { %>
                        <li class="nav-item">

                            <a class="nav-link" href="/registroVisitas">Registros</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/historial">Historial de visitantes</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/registrosPendientes">Pendientes de Salida</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/registroUsuario">Registrar Usuario</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/AdmistrarUsuario">Control de Usuarios</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/hr-visits">Recursos Humanos</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/historialInternos">Historial de pasante </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/controlPasantes">Control de Pasantes</a>
                        </li>
                        <% } %>
                            <div class="menu-hamburguesa bg-primary">
                                <div class="hamburguesa-icono"></div>
                            </div>
                            
                </ul>
            </div>
        </div>
    </nav>

    <h1 class="text-white mb-0" style="font-size: 25px; margin-right: auto;">
        <%= description %>
    </h1>
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Buscar...">
        <button type="button" onclick="search()"><i class="bi bi-search"></i></button>
    </div>

    <table id="tabla" class="fade-in">
        <thead class="thead-gray">
            <tr>
                <th>Nombre</th>
                <th>Teléfono</th>
                <th>Correo Electrónico</th>
                <th>CURP</th>
                <th>Identificación</th>
                <th>Origen</th>
                <th>Niños</th>
                <th>Número de Pase</th>
                <th>Fecha de Entrada</th>
                <th>Fecha de Salida</th>
            </tr>
        </thead>
        <tbody>
            <% visits.forEach(visit=> { %>
                <tr>
                    <td>
                        <%= visit.name %>
                    </td>
                    <td>
                        <%= visit.phone %>
                    </td>
                    <td>
                        <%= visit.email %>
                    </td>
                    <td>
                        <%= visit.CURP %>
                    </td>
                    <td>
                        <%= visit.identification %>
                    </td>
                    <td>
                        <%= visit.origin %>
                    </td>
                    <td>
                        <%= visit.children %>
                    </td>
                    <td>
                        <%= visit.badge %>
                    </td>
                    <td>
                        <%= visit.entrance %>
                    </td>
                    <td>
                        <%= visit.exit %>
                    </td>
                </tr>
                <% }); %>
        </tbody>
    </table>
    <script>
        function normalizeString(str) {
            return str.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
        }

        document.getElementById('searchInput').addEventListener('input', function () {
            const searchValue = normalizeString(this.value);
            const table = document.getElementById('tabla');
            const rows = table.getElementsByTagName('tr');

            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                const name = normalizeString(cells[0].textContent || cells[0].innerText);
                const curp = normalizeString(cells[3].textContent || cells[3].innerText);
                const entranceDate = normalizeString(cells[8].textContent || cells[8].innerText);

                if (name.includes(searchValue) || curp.includes(searchValue) || entranceDate.includes(searchValue)) {
                    rows[i].style.display = '';
                } else {
                    rows[i].style.display = 'none';
                }
            }
        });
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>

</html>